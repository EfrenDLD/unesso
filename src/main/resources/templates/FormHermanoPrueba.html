<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <link rel="stylesheet" th:href="@{/css/style.css}" />
     <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <title>Beca mi familia</title>
</head>

<body>


	<form action="#" th:action="@{/hermanos/save}" th:object="${form}"
	  method="post" enctype="multipart/form-data">
	    <fieldset>
	        <input type="submit" id="submitButton" th:value="Save">
	        <input type="reset" id="resetButton" name="reset" th:value="Reset"/>
	        <table>
	            <thead>
	                <tr>
	                    <th> Title</th>
	                    <th> Author</th>
	                </tr>
	            </thead>
	            <tbody>
					<!--
	                <tr th:each="hermano, itemStat : *{hermanos}">
	                    <td><input th:field="*{hermanos[__${itemStat.index}__].nombreHermanos}" /></td>
	                    <td><input th:field="*{hermanos[__${itemStat.index}__].edad}" /></td>
	                    <td><input th:field="*{hermanos[__${itemStat.index}__].nombreEscuela}" /></td>
	                </tr>
	                -->
	                
	                <!--
	                <tr th:each="hermano, itemStat : ${form.hermanos}">
						<td>
					        <input hidden th:name="|hermanos[${itemStat.index}].idHermanos|" th:value="${hermano.getIdHermanos()}"/>
					    </td>
					    <td>
					        <input th:field="*{hermanos[__${itemStat.index}__].nombreHermanos}" th:name="|hermanos[${itemStat.index}].nombreHermanos|" th:value="${hermano.getNombreHermanos()}"/>
					    </td>
					    <td>
					        <input th:field="*{hermanos[__${itemStat.index}__].edad}" th:name="|hermanos[${itemStat.index}].edad|" th:value="${hermano.getEdad()}"/>
					    </td>
					    <td>
					        <input th:name="|hermanos[${itemStat.index}].nombreEscuela|" th:value="${hermano.getNombreEscuela()}"/>
					    </td>
					    <td>
					        <input type="file" name="file"/>
					    </td>
					</tr>
					-->
					
					
					<div class="mb-3">
		                <label for="numHermanos" class="form-label">Número de Hermanos</label>
		                <input type="number" class="form-control" id="numHermanos" min="1">
		                <button type="button" class="btn btn-primary mt-2" id="generateFields">Generar Campos</button>
		            </div>
		            <div id="hermanosFields">
		                <!-- Aquí se agregarán los campos dinámicamente -->
		                <div th:if="${form.hermanos}">
							<tr th:each="hermano, itemStat : ${form.hermanos}">
								<td>
							        <input hidden th:name="|hermanos[${itemStat.index}].idHermanos|" th:value="${hermano.getIdHermanos()}"/>
							    </td>
							    <td>
							        <input th:field="*{hermanos[__${itemStat.index}__].nombreHermanos}" th:name="|hermanos[${itemStat.index}].nombreHermanos|" th:value="${hermano.getNombreHermanos()}"/>
							    </td>
							    <td>
							        <input th:field="*{hermanos[__${itemStat.index}__].edad}" th:name="|hermanos[${itemStat.index}].edad|" th:value="${hermano.getEdad()}"/>
							    </td>
							    <td>
							        <input th:name="|hermanos[${itemStat.index}].nombreEscuela|" th:value="${hermano.getNombreEscuela()}"/>
							    </td>
							    <td>
							        <input type="file" name="file"/>
							    </td>
							</tr>							
		                </div>
		            </div>
	            </tbody>
	        </table>
	    </fieldset>
	</form>
</body>
  <script>
        $(document).ready(function() {
            $('#generateFields').click(function() {
                // Verificar si ya hay hermanos en la lista
                if ($('#hermanosFields').children().length > 0) {
                    alert("La lista de hermanos ya contiene elementos.");
                    return;
                }

                var numHermanos = $('#numHermanos').val();
                var hermanosFields = $('#hermanosFields');
                hermanosFields.empty();

                for (var i = 0; i < numHermanos; i++) {
                    hermanosFields.append(`
                        <fieldset class="mb-3">
                            <legend>Hermano ${i + 1}</legend>
                            <div class="mb-3">
                                <label for="hermanos[${i}].nombreHermanos" class="form-label">Nombre</label>
                                <input type="text" class="form-control" name="hermanos[${i}].nombreHermanos">
                            </div>
                            <div class="mb-3">
                                <label for="hermanos[${i}].edad" class="form-label">Edad</label>
                                <input type="number" class="form-control" name="hermanos[${i}].edad">
                            </div>
                            <div class="mb-3">
                                <label for="hermanos[${i}].nombreEscuela" class="form-label">Nombre de la Escuela</label>
                                <input type="text" class="form-control" name="hermanos[${i}].nombreEscuela">
                            </div>
                            <div class="mb-3">
                                <label for="file" class="form-label">Archivo</label>
                                <input type="file" class="form-control" name="file">
                            </div>
                        </fieldset>
                    `);
                }
            });
        });
    </script>
</html>